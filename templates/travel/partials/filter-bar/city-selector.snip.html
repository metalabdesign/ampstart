{{!
<!---
Copyright 2016 The AMP Start Authors. All Rights Reserved.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS-IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->
}}

<amp-list
  class="block-list checkbox-selector"
  layout="flex-item"
  {{> ../util/list-src.snip.html}}
>
  <template type="amp-mustache">
    {{=[[ ]]=}}
      <amp-selector
        layout="container"
        name="city"
        multiple
        on="
          select:
            AMP.setState({
              fields_city: fields_city.includes(event.targetOption)
                ? copyAndSplice(fields_city, fields_city.indexOf(event.targetOption), 1)
                : fields_city.concat([event.targetOption]),
              fields_city_edited: true
            })
        "
        [selected]="fields_city"
      >
        {{#stats.cities}}
          <!--
            "The attribute 'option' may not appear in tag 'div'."
            see: https://github.com/ampproject/amphtml/pull/9585
          -->
          {{#isSelected}}<div option="{{name}}" selected>{{/isSelected}}
          {{^isSelected}}<div option="{{name}}">{{/isSelected}}
            <span>
              <!--
                amp-img fails to load inside amp-list inside amp-carousel
                see: https://jsbin.com/beyoruz/edit?html,output
              -->
              <amp-img layout="flex-item" src="{{img}}"></amp-img>
              {{name}}
            </span>
          </div>
        {{/stats.cities}}
      </amp-selector>
    [[={{ }}=]]
  </template>
</amp-list>
