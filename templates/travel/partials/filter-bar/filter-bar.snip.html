{{!
<!---
Copyright 2016 The AMP Start Authors. All Rights Reserved.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS-IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->
}}

<section>
  <div class="flex border-bottom border-silver mxn1 px1 md-px2">
    <div class="flex flex-auto border-right border-silver">
      <div class="px1 py2 nowrap">
        <span class="pointer" role="button" tabindex="-1" on="tap:AMP.setState({ui_filterPane: !ui_filterPane, ui_sortPane: false})">
          <span class="bold">Filters</span>
          <span class="gray">{{> ../icon/caret-down-small.snip.html}}</span>
        </span>
      </div>

      <div class="pl1 py2 nowrap">
        <span class="gray">Price</span>
      </div>

      <div class="min-0">
        <div class="fade-right pr1 py2">
          <span
            class="badge gray"
            [class]="query_maxPrice < 801 ? 'badge green' : 'badge gray'"
            [text]="query_maxPrice < 801 ? 'Up to $' + round(query_maxPrice) : 'Any price'"
          >Any price</span>
        </div>
      </div>

      <div class="pl1 py2 nowrap">
        <span class="gray">Type</span>
      </div>

      <div class="min-0">
        <div class="fade-right pr1 py2">
          <span
            class="badge gray"
            [class]="'badge gray' + (query_type.length > 0 && query_type.length < {{data.types.length}} ? ' hide' : '')"
          >All types</span>

          {{#data.types}}<span class="badge green hide" [class]="'badge green' + (query_type.includes('{{value}}') ? '' : ' hide')">{{text}}</span>{{/data.types}}
        </div>
      </div>

      <div class="pl1 py2 nowrap">
        <span class="gray">City</span>
      </div>

      <div class="flex-auto min-0">
        <div class="fade-right pr1 py2">
          <amp-list
            class="inline-list"
            layout="flex-item"
            {{> ../util/list-src.snip.html}}
          >
            <template type="amp-mustache">
              {{=[[ ]]=}}
              {{#stats.allCities}}<span class="badge gray">All cities</span>{{/stats.allCities}}
              {{^stats.allCities}}
              {{#stats.cities}}{{#isSelected}}<span class="badge green">{{name}}</span>{{/isSelected}}{{/stats.cities}}
              {{/stats.allCities}}
              [[={{ }}=]]
            </template>
          </amp-list>
        </div>
      </div>

      <div class="px1 md-pr2 py2 nowrap">
        <amp-list
          class="inline-list"
          layout="flex-item"
          {{> ../util/list-src.snip.html}}
        >
          <template type="amp-mustache">
            {{=[[ ]]=}}
            <span class="purple">{{stats.resultCount}} <span class="sm-hide xs-hide md-hide">Tours &amp; Activities</span> Found</span>
            [[={{ }}=]]
          </template>
        </amp-list>
      </div>
    </div>

    <div class="px1 py2 md-pl2 nowrap">
      <span role="button" tabindex="-1"  class="pointer" on="tap:AMP.setState({ui_filterPane: false, ui_sortPane: !ui_sortPane})">
        <span class="gray">Sort by</span>
        <span class="bold">
          {{#data.sort}}
            <span {{^selected}}class="hide"{{/selected}} [class]="fields_sort == '{{value}}' ? '' : 'hide'">
              {{text}}
            </span>
          {{/data.sort}}
        </span>
        <span class="gray">{{> ../icon/caret-down-small.snip.html}}</span>
      </span>
    </div>
  </div>

  <!-- Filter pane -->
  <div class="pane" [class]="'pane' + (ui_filterPane ? ' pane-visible' : '')">
    <div class="pane-overflow left-0 right-0 pb2">
      <div class="pane-content shadow bg-white border-bottom border-silver z1">
        <div class="container px1 md-px2 py1">
          <div class="clearfix mxn2 py1">
            <div class="col col-4 px2">
              <div class="h5 gray mb1">MAX PRICE</div>
              {{> ./price-range.snip.html}}
            </div>
            <div class="col col-4 px2">
              <div class="h5 gray mb2">TYPE</div>
              {{> ./type-selector.snip.html}}
            </div>
            <div class="col col-4 px2">
              <div class="h5 gray mb2">CITY</div>
              {{> ./city-selector.snip.html}}
            </div>
          </div>
        </div>
        <div class="mx1 md-mx2 border-top border-silver"></div>
        <div class="container px1 md-px2 py1 center">
          {{> ./action-buttons.snip.html}}
        </div>
      </div>
    </div>
  </div>
  <!--/ Filter pane -->

  <!-- Sort pane -->
  <div class="pane" [class]="'pane' + (ui_sortPane ? ' pane-visible' : '')">
    <div class="pane-overflow right-0 pb2 pl2">
      <div class="pane-content shadow bg-white border-bottom border-left border-silver z1">
        <div class="p1">
          <amp-selector
            layout="container"
            name="sort"
            on="
              select:AMP.setState({
                query_sort: event.targetOption,
                fields_sort: event.targetOption
              })
            "
            [selected]="fields_sort"
          >
            {{#data.sort}}
              <div option="{{value}}"{{#selected}} selected{{/selected}}>{{text}}</div>
            {{/data.sort}}
          </amp-selector>
        </div>
      </div>
    </div>
  </div>
  <!--/ Sort pane -->
</section>
